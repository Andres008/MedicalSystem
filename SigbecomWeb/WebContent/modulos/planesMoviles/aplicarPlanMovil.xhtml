<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">

<h:head>
	<f:facet name="first">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
        <meta name="apple-mobile-web-app-capable" content="yes" />
    </f:facet>
        <title><ui:insert name="title">Plan Móvil</ui:insert></title>
        <h:outputScript name="js/nanoscroller.js" library="california-layout" />
        <h:outputScript name="js/layout.js" library="california-layout" />
        <h:outputStylesheet library="css" name="theme.css"/>
</h:head>

<h:body styleClass="main-body">

        <div class="layout-wrapper #{guestPreferences.menuLayout != 'static' ? guestPreferences.menuLayout : null}">
            <ui:include src="/affordances/megamenu.xhtml" />
            <ui:include src="/affordances/topbar.xhtml" />
            <ui:include src="/affordances/sidebar.xhtml" />
            <ui:include src="/affordances/right-sidebar.xhtml" />
			<div class="layout-main">
                <div class="route-bar">
                    <div class="route-bar-breadcrumb">
                        <i class="fa fa-home"></i> <span>/PLANES MOVILES/Plan Móvil</span>
                        <ui:insert name="viewname" />
                    </div>
					<ui:include src="/affordances/route-bar-menu.xhtml" />
                </div>
				<div class="layout-main-content" align="center">
                    <H1>Gestión Planes Móviles</H1>
                    <h:form id="form1">
	                    <p:growl id="growl" showDetail="true" sticky="true" />
						<p:panel header="Registro Planes Moviles" toggleable="true" collapsed="true">
							<p:panelGrid columns="4" styleClass="ui-noborder" layout="grid"
								columnClasses="ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4">
								<p:outputLabel for="nom" value="Seleccione Cliente:" />
								<p:selectOneMenu id="nom" value="#{frmAplicarPlanMovil.cedulaSocio}"
												 filter="true" filterMatchMode="contains">
			                    <f:selectItem itemLabel="Seleccione Cliente"
										noSelectionOption="true" />
			                    <f:selectItems value="#{frmAplicarPlanMovil.lstUsrSocio}" var="dat"
			                    			itemLabel="#{dat.cedulaSocio} #{dat.gesPersona.apellidos} #{dat.gesPersona.nombres}" itemValue="#{dat.cedulaSocio}"/>
			                    </p:selectOneMenu>
								<p:commandButton icon="fa fa-handshake-o"  value="Agregar Cliente" update="@form" style="width:170px;"
	                    			action="#{frmAplicarPlanMovil.cargarContrato()}"/>
							</p:panelGrid>
							<p:panelGrid columns="4" styleClass="ui-noborder" layout="grid" rendered="#{frmAplicarPlanMovil.pnlPlanMovil}"
								columnClasses="ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4">
								<p:outputLabel  value="Seleccionar Plan Movil:" />
								<p:selectOneMenu id="plan" value="#{frmAplicarPlanMovil.idPlanMovil}"
												 filter="true" filterMatchMode="contains">
			                    	<f:selectItem itemLabel="Seleccione Cliente" noSelectionOption="true" />
			                    	<f:selectItems value="#{frmAplicarPlanMovil.lstPlanMovils}" var="dat"
			                    			itemLabel="#{dat.plan} #{dat.detalle}" itemValue="#{dat.idPlanMovil}"/>
			                    </p:selectOneMenu>
								<p:commandButton icon="fa fa-handshake-o"  value="Agregar Plan" update="@form" style="width:170px;"
	                    			action="#{frmAplicarPlanMovil.cargarPlanMovil()}"/>
							</p:panelGrid>
							<p:panelGrid  columns="4" styleClass="ui-noborder" layout="grid" rendered="#{frmAplicarPlanMovil.pnlEquipo}"
								columnClasses="ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4">
								<p:outputLabel  value="Seleccionar Equipo Movil:" />
								<p:selectOneMenu id="equipo" value="#{frmAplicarPlanMovil.idEquipo}"
												 filter="true" filterMatchMode="contains">
			                    	<f:selectItem itemLabel="Seleccione Equipo Móvil" noSelectionOption="true" />
			                    	<f:selectItems value="#{frmAplicarPlanMovil.lstEquipos}" var="dat"
			                    			itemLabel="#{dat.equipo} #{dat.detalle}" itemValue="#{dat.idEquipo}"/>
			                    </p:selectOneMenu>
								<p:commandButton icon="fa fa-handshake-o"  value="Agregar Equipo" update="@form" style="width:170px;"
	                    			action="#{frmAplicarPlanMovil.cargarEquipoMovil()}"/>
							</p:panelGrid>
							<p:separator/>
							<p:panelGrid columns="3" styleClass="ui-noborder"
										 columnClasses="ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4, ui-g-12 ui-md-6 ui-lg-4">
								<p:panelGrid columns="2" styleClass="ui-noborder" rendered="#{frmAplicarPlanMovil.panelCliente}">
									<p:outputLabel  value="Cedula:" />
									<p:outputLabel  value="#{frmAplicarPlanMovil.planContratoComite.usrSocio.cedulaSocio}"/>
									<p:outputLabel  value="Nombres:" />
									<p:outputLabel  value="#{frmAplicarPlanMovil.planContratoComite.usrSocio.gesPersona.apellidos} #{frmAplicarPlanMovil.planContratoComite.usrSocio.gesPersona.nombres}"/>
									<p:outputLabel for="cel"  value="Número de Celular:" />
									<p:inputText id="cel" required="true" value="#{frmAplicarPlanMovil.planContratoComite.lineaTelefono}"/>
									<p:outputLabel for="feCli"  value="Fecha Contrato:" />
									<p:datePicker id="feCli" required="true" showIcon="true" size="15"
										 value="#{frmAplicarPlanMovil.planContratoComite.fechaContrato}" />
								</p:panelGrid>
								<p:panelGrid columns="2" styleClass="ui-noborder" rendered="#{frmAplicarPlanMovil.panelPlan}">
									<p:outputLabel  value="Plan:" />
									<p:outputLabel  value="#{frmAplicarPlanMovil.planContratoComite.planPlanMovil.plan}"/>
									<p:outputLabel  value="Detalle:" />
									<p:outputLabel  value="#{frmAplicarPlanMovil.planContratoComite.planPlanMovil.detalle}"/>
									<p:outputLabel for="prePlan"  value="Precio:" />
									<p:inputText id="prePlan" value="#{frmAplicarPlanMovil.planContratoComite.valorPlanMovil}">
										<f:convertNumber pattern="#0.00" />
									</p:inputText>
									<p:outputLabel for="inPlan" value="Interes:" />
									<p:inputText id="inPlan" value="#{frmAplicarPlanMovil.planContratoComite.interesPlanMovil}">
										<f:convertNumber pattern="#0.00" />
									</p:inputText>
								</p:panelGrid>		
								<p:panelGrid columns="2" styleClass="ui-noborder" rendered="#{frmAplicarPlanMovil.panelEquipo}">
									<p:outputLabel  value="Equipo:" />
									<p:outputLabel  value="#{frmAplicarPlanMovil.planContratoComite.planEquipo.equipo}"/>
									<p:outputLabel  value="Detalle:" />
									<p:outputLabel  value="#{frmAplicarPlanMovil.planContratoComite.planEquipo.detalle}"/>
									<p:outputLabel for="preMov"  value="Precio:" />
									<p:inputText id="preMov" required="true" value="#{frmAplicarPlanMovil.planContratoComite.valorEquipo}">
										<f:convertNumber pattern="#0.00" />
									</p:inputText>
									<p:outputLabel for="inMov"  value="Interes:" />
									<p:inputText id="inMov" required="true" value="#{frmAplicarPlanMovil.planContratoComite.interesEquipo}">
										<f:convertNumber pattern="#0.00" />
									</p:inputText>
								</p:panelGrid>
							</p:panelGrid>
							<p:panelGrid columns="2" styleClass="ui-noborder">
								<p:commandButton value="Cancelar"
									action="#{frmAplicarPlanMovil.init()}" update="@form">
								</p:commandButton>							
								<p:commandButton value="Registrar"
									action="#{frmAplicarPlanMovil.registrarPlanMovil()}" update="@form">
									<p:confirm header="Confirmación"
									message="Esta seguro de ingresar la información?"
									icon="pi pi-exclamation-triangle" />
								</p:commandButton>
							</p:panelGrid>	
							<p:confirmDialog global="true" showEffect="fade" hideEffect="fade"
								responsive="true" width="350">
								<p:commandButton value="Si" type="button"
									styleClass="ui-confirmdialog-yes" />
								<p:commandButton value="No" type="button"
									styleClass="ui-confirmdialog-no ui-button-flat" />
							</p:confirmDialog>
							
	                    </p:panel>
	                    <p:separator/>
	                </h:form>
	                <h:form id="form2">
	                	<p:growl id="growl" showDetail="true" sticky="true" />
	                	<p:panel id="pnl"  header="LISTADO PLANES MOVILES USUARIOS ">
						<p:dataTable value="#{frmAplicarPlanMovil.lstUsersSocios}"
							id="tblEmp"  var="dato" paginator="true"
							rows="10">
							<f:facet name="header">
								LISTADO DE SOCIOS
							</f:facet>
							<p:column headerText="" style="width:2rem">
								<p:rowToggler />
							</p:column>
							<p:column headerText="CEDULA" filterBy="#{dato.cedulaSocio}">
								<h:outputText value="#{dato.cedulaSocio}"/>
							</p:column>
							<p:column headerText="APELLIDOS" filterBy="#{dato.gesPersona.apellidos}">
								<h:outputText value="#{dato.gesPersona.apellidos}"/>
							</p:column>
							<p:column headerText="NOMBRES" filterBy="#{dato.gesPersona.nombres}">
								<h:outputText value="#{dato.gesPersona.nombres}"/>
							</p:column>
							
							<p:rowExpansion>
								<p:panel>
									<p:dataTable value="#{dato.planContratoComites}"  
													id="tblCon" editable="true" var="con">
										<f:facet name="header">
								            LISTADO DE PLANES MOVILES 
										</f:facet>
										<p:ajax event="rowEdit" listener="#{frmAplicarPlanMovil.onRowEdit}" update="form2:growl"/>
            							<p:ajax event="rowEditCancel" listener="#{frmAplicarPlanMovil.onRowCancel}" update="form2:growl"/>
										<p:column headerText="FECHA CONTRATO" >
											<h:outputText value="#{con.fechaContrato}" />
										</p:column>
										<p:column headerText="PLAN MOVIL" >
											<h:outputText value="#{con.planPlanMovil.plan}" />
										</p:column>
										<p:column headerText="VALOR PLAN">
								           <p:cellEditor>
							                    <f:facet name="output">
							                        <h:outputText value="#{con.valorPlanMovil}">
							                        	<f:convertNumber pattern="#0.00" />
							                        </h:outputText>
							                    </f:facet>
							                    <f:facet name="input">
							                        <p:inputText value="#{con.valorPlanMovil}" style="width:100%">
							                        	<f:convertNumber pattern="#0.00" />
							                        </p:inputText>
							                    </f:facet>
							                </p:cellEditor>
								        </p:column>
								        <p:column headerText="INTERES PLAN">
								           	<p:cellEditor>
								           		<f:facet name="output">
							                        <h:outputText value="#{con.interesPlanMovil}">
										           		<f:convertNumber pattern="#0.00" />
										           </h:outputText>
							                    </f:facet>
							                    <f:facet name="input">
							                        <p:inputText value="#{con.interesPlanMovil}" style="width:100%">
							                        	<f:convertNumber pattern="#0.00" />
							                        </p:inputText>
							                    </f:facet>
							            	</p:cellEditor>
								        </p:column>
								        <p:column headerText="ESTADO PLAN">
								           	<p:cellEditor>
								           		<f:facet name="output">
							                        <h:outputText value="#{con.estadoPlanMovil}"/>
										        </f:facet>
							                    <f:facet name="input">
							                        <h:selectOneMenu id="option" value="#{con.estadoPlanMovil}" style="width:100%">
									                   	<f:selectItem itemLabel="Seleccione Valor" noSelectionOption="true"/>
									                   	<f:selectItem itemLabel="ACTIVO" itemValue="ACTIVO"/>
									                    <f:selectItem itemLabel="INACTIVO" itemValue="INACTIVO"/>
									                </h:selectOneMenu>
							                    </f:facet>
							            	</p:cellEditor>
								        </p:column>
								        <p:column headerText="EQUIPO MOVIL">
								           <h:outputText value="#{con.planEquipo.equipo}"/>
								        </p:column>
								        <p:column headerText="VALOR EQUIPO">
								           <p:cellEditor>
							                    <f:facet name="output">
							                        <h:outputText value="#{con.valorEquipo}">
							                        	<f:convertNumber pattern="#0.00" />
							                        </h:outputText>
							                    </f:facet>
							                    <f:facet name="input">
							                        <p:inputText value="#{con.valorEquipo}" style="width:100%">
							                        	<f:convertNumber pattern="#0.00" />
							                        </p:inputText>
							                    </f:facet>
							                </p:cellEditor>
								        </p:column>
								        <p:column headerText="INTERES EQUIPO">
								           
								           <p:cellEditor>
								           		<f:facet name="output">
							                        <h:outputText value="#{con.interesEquipo}">
										           		<f:convertNumber pattern="#0.00" />
										           </h:outputText>
							                    </f:facet>
							                    <f:facet name="input">
							                        <p:inputText value="#{con.interesEquipo}" style="width:100%">
							                        	<f:convertNumber pattern="#0.00" />
							                        </p:inputText>
							                    </f:facet>
							            	</p:cellEditor>
								        </p:column>
								        <p:column headerText="ESTADO PLAN">
								          	<p:cellEditor>
								           		<f:facet name="output">
							                         <h:outputText value="#{con.estadoEquipo}"/>
										        </f:facet>
							                    <f:facet name="input">
							                        <h:selectOneMenu  value="#{con.estadoEquipo}" style="width:100%">
									                   	<f:selectItem itemLabel="Seleccione Valor" noSelectionOption="true"/>
									                   	<f:selectItem itemLabel="ACTIVO" itemValue="ACTIVO"/>
									                    <f:selectItem itemLabel="INACTIVO" itemValue="INACTIVO"/>
									                </h:selectOneMenu>
							                    </f:facet>
							            	</p:cellEditor>
								        </p:column>
								        <p:column headerText="VALOR NO SOCIO">
								        	<p:cellEditor>
							                    <f:facet name="output">
							                        <h:outputText value="#{con.valorNoSocio}">
							                        	<f:convertNumber pattern="#0.00" />
							                        </h:outputText>
							                    </f:facet>
							                    <f:facet name="input">
							                        <p:inputText value="#{con.valorNoSocio}" style="width:100%">
							                        	<f:convertNumber pattern="#0.00" />
							                        </p:inputText>
							                    </f:facet>
							                </p:cellEditor>
								        </p:column>
								        <p:column width="6">
												<p:rowEditor editTitle="Edit Row" cancelTitle="Cancel Edit" saveTitle="Save Row"/>
							            </p:column>
									</p:dataTable>
								</p:panel>
								
							</p:rowExpansion>
						</p:dataTable>
						<br/>
						<br/>
						<p:separator/>
						<p:panelGrid columns="2" styleClass="ui-noborder">
								<p:commandButton value="Generar Planilla Mes"
									action="#{frmAplicarPlanMovil.generarPlanillaMes()}" update="form2">
									<p:confirm header="Confirmación"
									message="Esta seguro de ingresar la información?"
									icon="pi pi-exclamation-triangle" />
								</p:commandButton>
							</p:panelGrid>	
					</p:panel>
	                </h:form>
<!-- Inicio de Dialogs -->

<p:dialog
	header="REGISTRO DE CONTACTO"  resizable="false" closable="true"
	widgetVar="dlgReg" modal="true" position="center"
	hideEffect="fade" >
	<h:form id="frmReg">
		<p:messages id="msgReg" closable="true" showDetail="false"/>
		<p:panelGrid columns="2">
			<p:outputLabel for="nomb" value="Nombres:"/>
			<p:inputText id="nomb" value="#{frmRegistroOperadora.planContacto.nombres}" required="true"/>
			<p:outputLabel for="ape" value="Apellidos:"/>
			<p:inputText id="ape" value="#{frmRegistroOperadora.planContacto.apellidos}" required="true"/>
			<p:outputLabel for="car" value="Cargo:"/>
			<p:inputText id="car" value="#{frmRegistroOperadora.planContacto.cargo}" required="true"/>
			<p:outputLabel for="cel" value="Celular:"/>
			<p:inputText id="cel" value="#{frmRegistroOperadora.planContacto.celular}" required="true"/>
			<p:outputLabel for="ema" value="E-mail:"/>
			<p:inputText id="ema" value="#{frmRegistroOperadora.planContacto.email}" required="true"/>
		</p:panelGrid>
		<p:panel>
			<h:panelGrid columns="2" cellpadding="10">
				<p:commandButton value="Cancelar" onclick="PF('dlgReg').hide();" update="form2 frmReg"
				action="#{frmRegistroOperadora.init()}"/>
				<p:commandButton value="Registrar" 
					action="#{frmRegistroOperadora.registrarContacto()}" update="frmReg"/>
			</h:panelGrid>
		</p:panel>
	</h:form>
</p:dialog>
<p:dialog
	header="REGISTRO PLANES MOVILES"  resizable="false" closable="true"
	widgetVar="dlgSer" modal="true" position="center"
	hideEffect="fade" >
	<h:form id="frmSer">
		<p:messages id="msgSer" closable="true" showDetail="true"/>
		<p:panelGrid columns="2">
			<p:outputLabel for="ser" value="Plan Móvil:"/>
			<p:inputText id="ser" value="#{frmRegistroOperadora.planPlanMovil.plan}" />
			<p:outputLabel for="det" value="Detalle:"/>
			<p:inputText id="det" value="#{frmRegistroOperadora.planPlanMovil.detalle}"/>
			<p:outputLabel for="mon" value="Precio:"/>
			<p:inputText id="mon" value="#{frmRegistroOperadora.planPlanMovil.precio}"/>
			<p:outputLabel for="in" value="Interes:"/>
			<p:inputText id="in" value="#{frmRegistroOperadora.planPlanMovil.interes}"/>
		</p:panelGrid>
		<p:panel>
			<h:panelGrid columns="2" cellpadding="10">
				<p:commandButton value="Cancelar" onclick="PF('dlgReg').hide();" update="form2 frmSer"
					action="#{frmRegistroOperadora.init()}"/>
				<p:commandButton value="Registrar"
					action="#{frmRegistroOperadora.registrarPlanMovil()}" update="frmSer"/>
			</h:panelGrid>
		</p:panel>
	</h:form>
</p:dialog>

<p:dialog
	header="REGISTRO EQUIPOS MOVILES"  resizable="false" closable="true"
	widgetVar="dlgEq" modal="true" position="center"
	hideEffect="fade" >
	<h:form id="frmEq">
		<p:messages id="msgEq" closable="true" showDetail="true"/>
		<p:panelGrid columns="2">
			<p:outputLabel for="eq" value="Equipo Móvil:"/>
			<p:inputText id="eq" value="#{frmRegistroOperadora.planEquipo.equipo}" />
			<p:outputLabel for="det" value="Detalle:"/>
			<p:inputText id="det" value="#{frmRegistroOperadora.planEquipo.detalle}"/>
			<p:outputLabel for="mon" value="Precio Referencial:"/>
			<p:inputText id="mon" value="#{frmRegistroOperadora.planEquipo.precioRef}"/>
			<p:outputLabel for="cuo" value="Cuota Referencial:"/>
			<p:inputText id="cuo" value="#{frmRegistroOperadora.planEquipo.cuotaRef}"/>
			<p:outputLabel for="in" value="Interes:"/>
			<p:inputText id="in" value="#{frmRegistroOperadora.planEquipo.interes}"/>
		</p:panelGrid>
		<p:panel>
			<h:panelGrid columns="2" cellpadding="10">
				<p:commandButton value="Cancelar" onclick="PF('dlgEq').hide();" update="form2 frmEq"
					action="#{frmRegistroOperadora.init()}"/>
				<p:commandButton value="Registrar"
					action="#{frmRegistroOperadora.registrarEquipoMovil()}" update="frmEq"/>
			</h:panelGrid>
		</p:panel>
	</h:form>
</p:dialog>

<!-- Fin de Dialogs -->
                </div>
				<ui:include src="/affordances/footer.xhtml" />
            </div>
        </div>
		
        <p:ajaxStatus style="width:32px;height:32px;position:fixed;right:7px;bottom:7px">
           <f:facet name="start">
               <i class="fa fa-circle-o-notch fa-spin ajax-loader" aria-hidden="true"></i>
           </f:facet>

           <f:facet name="complete">
               <h:outputText value="" />
           </f:facet>
       </p:ajaxStatus>

        <h:outputStylesheet name="css/nanoscroller.css" library="california-layout" />
        <h:outputStylesheet name="css/layout-#{guestPreferences.theme}.css" library="california-layout" />
    </h:body>
</html>

